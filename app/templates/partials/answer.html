{% import 'macros/helpers.html' as helpers %}

{% set invalid = answer.is_valid == False %}

<div class="answer answer--{{answer.schema_item.type|lower}} {{'js-has-errors' if invalid}}" id="{{answer.id}}">

  {%- set answer_guidance %}
    {% if answer.schema_item.guidance %}
      {% include 'partials/guidance.html' %}
    {% endif %}
  {% endset -%}
  
  {%- set answer_fields %}
    <div class="answer__fields">
      {% if answer.schema_item.display and answer.schema_item.display.properties %}
        {% set use_grid = answer.schema_item.display.properties.columns %}
      {% endif %}
      {% include 'partials/answers/' ~ answer.schema_item.type|lower ~ '.html' %}
    </div>
  {% endset -%}

  {% if invalid %}

    <div class="alert alert--simple alert--error">
      <div class="alert__header">
        {% if answer.errors %}
        <ul class="list list--bare list--errors">
          {% for error in answer.errors %}
          <li class="list__item mars" {{helpers.errorTracking(question.id, error)}}>{{ error }}</li>
          {% endfor %}
        </ul>
        {% endif %}
      </div>
      <div class="alert__body">
        {{answer_fields|safe}}
      </div>
    </div>

    {{answer_guidance|safe}}

  {% else %}
    {{answer_fields|safe}}
    {{answer_guidance|safe}}
  {% endif %}
</div>
